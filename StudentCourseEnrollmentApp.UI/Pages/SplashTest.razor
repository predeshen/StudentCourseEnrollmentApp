@page "/splash-test"
@using StudentCourseEnrollmentApp.UI.Services
@inject LoadingService LoadingService

<PageTitle>Splash Screen Test</PageTitle>

<div class="splash-test-container">
    <h1>ðŸŽ¬ Splash Screen Test Page</h1>
    <p>Use the buttons below to test different splash screen states:</p>
    
    <div class="test-buttons">
        <button class="btn btn-primary" @onclick="ShowSplash">Show Splash Screen</button>
        <button class="btn btn-secondary" @onclick="StartLoading">Start Loading</button>
        <button class="btn btn-success" @onclick="CompleteLoading">Complete Loading</button>
        <button class="btn btn-warning" @onclick="SetCustomProgress">Set 50% Progress</button>
        <button class="btn btn-info" @onclick="SetCustomMessage">Set Custom Message</button>
        <button class="btn btn-danger" @onclick="HideSplash">Hide Splash Screen</button>
    </div>
    
    <div class="current-status">
        <h3>Current Status:</h3>
        <p><strong>Loading:</strong> @(_isLoading ? "Yes" : "No")</p>
        <p><strong>Progress:</strong> @_progress%</p>
        <p><strong>Message:</strong> @_loadingMessage</p>
    </div>
</div>

@code {
    private bool _isLoading = false;
    private int _progress = 0;
    private string _loadingMessage = "";

    protected override async Task OnInitializedAsync()
    {
        LoadingService.LoadingStateChanged += OnLoadingStateChanged;
    }

    private void OnLoadingStateChanged(bool isLoading, int progress, string message)
    {
        _isLoading = isLoading;
        _progress = progress;
        _loadingMessage = message;
        StateHasChanged();
    }

    private void ShowSplash()
    {
        LoadingService.ShowLoading("Manual splash screen activated!");
    }

    private async Task StartLoading()
    {
        await LoadingService.StartLoadingAsync();
    }

    private async Task CompleteLoading()
    {
        await LoadingService.CompleteLoadingAsync();
    }

    private void SetCustomProgress()
    {
        LoadingService.SetProgress(50, "Halfway there!");
    }

    private void SetCustomMessage()
    {
        LoadingService.SetLoadingMessage("This is a custom loading message!");
    }

    private void HideSplash()
    {
        LoadingService.HideSplashScreen();
    }

    public void Dispose()
    {
        LoadingService.LoadingStateChanged -= OnLoadingStateChanged;
    }
}
